{
  "label": "Macro",
  "entries": {
    "Create New Character": {
      "name": "Crea un topo",
      "command": "await game.mausritter.autoCreateCharacter();"
    },
    "Generate Hex": {
      "name": "Genera esagono",
      "command": "const compendium_label = CONFIG.MAUSRITTER.tables.tables;\n\n(async () => {\n\tconst hexTypeList = [\n\t\t\"Casuale\",\n\t\t\"Zona rurale\",\n\t\t\"Foresta\",\n\t\t\"Fiume\",\n\t\t\"Città umana\",\n\t];\n\tlet selectList = \"\";\n\n\tfor (const option of hexTypeList) {\n\t\tselectList += `<option value='${option}'>${option}</option>`;\n\t}\n\n\tconst d = new Dialog({\n\t\ttitle: \"Seleziona tipo di esagono\",\n\t\tcontent: `<h2> Scegli il tipo di esagono </h2> <select style='margin-bottom:10px;'name='stat' id='stat'> ${selectList}</select> <br/>`,\n\t\tbuttons: {\n\t\t\troll: {\n\t\t\t\ticon: '<i class=\"fas fa-check\"></i>',\n\t\t\t\tlabel: \"Lancia\",\n\t\t\t\tcallback: (html) => hexType(html.find('[id=\"stat\"]')[0].value),\n\t\t\t},\n\t\t\tcancel: {\n\t\t\t\ticon: '<i class=\"fas fa-times\"></i>',\n\t\t\t\tlabel: \"Annulla\",\n\t\t\t\tcallback: () => {},\n\t\t\t},\n\t\t},\n\t\tdefault: \"roll\",\n\t\tclose: () => {},\n\t});\n\td.render(true);\n})();\n\nasync function hexType(hexType) {\n\tlet type = hexType;\n\tlet hexContents = \"\";\n\tlet hexDetails = \"\";\n\tlet buffer = \"\";\n\tconst randomHex = [\"Zona rurale\", \"Foresta\", \"Fiume\", \"Città umana\"];\n\n\tif (type === \"Casuale\") {\n\t\ttype = randomHex[Math.floor(Math.random() * randomHex.length)];\n\t}\n\n\tbuffer = await drawFromTable(`Esagono - ${type}`);\n\tbuffer = await buffer.roll();\n\thexContents = buffer.results[0].data.text;\n\n\tbuffer = await drawFromTable(\"Esagono - Dettaglio interessante\");\n\tbuffer = await buffer.roll();\n\thexDetails = buffer.results[0].data.text;\n\n\tconst message = `\n  <h2>${type}: </h2>\n  <b> Punto di riferimento: </b>${hexContents}</br>\n  <b> Dettaglio: </b><i>${hexDetails}</i></br>`;\n\n\tconst chatData = {\n\t\tcontent: message,\n\t\twhisper: ChatMessage.getWhisperRecipients(\"GM\"),\n\t};\n\n\tChatMessage.create(chatData);\n}\n\nasync function drawFromTable(tableName) {\n\tconst list_compendium = await game.packs.filter(\n\t\t(p) => p.documentName === \"RollTable\",\n\t);\n\tconst inside = await list_compendium\n\t\t.filter((p) => p.metadata.label === compendium_label)[0]\n\t\t.getDocuments();\n\tconst table = await inside.filter((p) => p.data.name === tableName)[0];\n\n\tif (!table) {\n\t\tui.notifications.warn(`Tabella ${tableName} non trovata.`, {});\n\t\treturn;\n\t}\n\treturn await table;\n}"
    },
    "NPC Generator": {
      "name": "Generatore PNG",
      "command": "const compendium_label = CONFIG.MAUSRITTER.tables.tables;\n\n(async () => {\n\tconst Appearance = await drawFromTable(CONFIG.MAUSRITTER.tables.npcAppearance);\n\tconst Birthsign = await drawFromTable(CONFIG.MAUSRITTER.tables.npcBirthsign);\n\tconst Quirk = await drawFromTable(CONFIG.MAUSRITTER.tables.npcQuirk);\n\tconst Social = await drawFromTable(CONFIG.MAUSRITTER.tables.npcSocial);\n\tconst Wants = await drawFromTable(CONFIG.MAUSRITTER.tables.npcWants);\n\tconst Relationship = await drawFromTable(CONFIG.MAUSRITTER.tables.npcRelationship);\n\tconst Birthname = await drawFromTable(CONFIG.MAUSRITTER.tables.firstName);\n\tconst Matriname = await drawFromTable(CONFIG.MAUSRITTER.tables.lastName);\n\n\tconst dexterity = attrRoll();\n\tconst strength = attrRoll();\n\tconst will = attrRoll();\n\tconst health = healthRoll();\n\n\tlet msg = \"\";\n\tmsg += `<p><b>Posizione sociale e compenso:</b> ${Social}</p>`;\n\tmsg += `<p><b>Aspetto:</b> ${Appearance}</p>`;\n\tmsg += `<p><b>Particolarità:</b> ${Quirk}</p>`;\n\tmsg += `<p><b>Desideri:</b> ${Wants}</p>`;\n\tmsg += `<p><b>Relazioni:</b> ${Relationship}</p>`;\n\n\tconst instantNPC = await Actor.create({\n\t\tname: `${Birthname} ${Matriname}`,\n\t\ttype: \"hireling\",\n\t\tdata: {\n\t\t\tdescription: {\n\t\t\t\tdisposition: Birthsign,\n\t\t\t},\n\t\t\tnotes: msg,\n\t\t\tstats: {\n\t\t\t\tdexterity: {\n\t\t\t\t\tmax: dexterity,\n\t\t\t\t\tvalue: dexterity,\n\t\t\t\t},\n\t\t\t\tstrength: {\n\t\t\t\t\tmax: strength,\n\t\t\t\t\tvalue: strength,\n\t\t\t\t},\n\t\t\t\twill: {\n\t\t\t\t\tmax: will,\n\t\t\t\t\tvalue: will,\n\t\t\t\t},\n\t\t\t},\n\t\t\thealth: {\n\t\t\t\tmax: health,\n\t\t\t\tvalue: health,\n\t\t\t},\n\t\t},\n\t});\n\n\tawait instantNPC.sheet.render(true);\n})();\n\n...(funzioni drawFromTable, attrRoll, healthRoll e randomHP invariate salvo commenti tradotti)..."
    },
    "Roll Stat": {
      "name": "Tiro caratteristica",
      "command": "game.mausritter.rollStatMacro();"
    },
    "Roll Weather": {
      "name": "Determina meteo",
      "command": "const compendium_label = CONFIG.MAUSRITTER.tables.tables;\n\n(async () => {\n\tconst seasonList = [\"Estate\", \"Autunno\", \"Inverno\", \"Primavera\"];\n\tlet selectList = \"\";\n\n\tfor (const option of seasonList) {\n\t\tselectList += `<option value='${option}'>${option}</option>`;\n\t}\n\n\tconst d = new Dialog({\n\t\ttitle: \"Seleziona stagione\",\n\t\tcontent: `<h2> Stagione </h2> <select style='margin-bottom:10px;'name='stat' id='stat'> ${selectList}</select><br/>`,\n\t\tbuttons: {\n\t\t\troll: {\n\t\t\t\ticon: '<i class=\"fas fa-check\"></i>',\n\t\t\t\tlabel: \"Lancia\",\n\t\t\t\tcallback: (html) =>\n\t\t\t\t\tdrawFromTable(`Meteo - ${html.find('[id=\"stat\"]')[0].value}`),\n\t\t\t},\n\t\t\tcancel: {\n\t\t\t\ticon: '<i class=\"fas fa-times\"></i>',\n\t\t\t\tlabel: \"Annulla\",\n\t\t\t\tcallback: () => {},\n\t\t\t},\n\t\t},\n\t\tdefault: \"roll\",\n\t\tclose: () => {},\n\t});\n\td.render(true);\n})();\n\nasync function drawFromTable(tableName) {\n\tconst list_compendium = await game.packs.filter(\n\t\t(p) => p.documentName === \"RollTable\",\n\t);\n\tconst inside = await list_compendium\n\t\t.filter((p) => p.metadata.label === compendium_label)[0]\n\t\t.getDocuments();\n\tconst table = await inside.filter((p) => p.data.name === tableName)[0];\n\n\tif (!table) {\n\t\tui.notifications.warn(`Tabella ${tableName} non trovata.`, {});\n\t\treturn;\n\t}\n\n\tlet weather = await table.roll();\n\tweather = weather.results[0].data.text;\n\tconst message = `<h2>Meteo: </h2><b style='font-size:120%;'>${weather}</br>`;\n\n\tconst chatData = {\n\t\tcontent: message,\n\t\twhisper: ChatMessage.getWhisperRecipients(\"GM\"),\n\t};\n\n\tChatMessage.create(chatData);\n}"
    }
  }
}
